name: 'Julia Lint'
description: 'Lint Julia files'
runs:
  using: "composite"
  steps:
    - run: |
        echo "Trying various things"
        echo "${{ format('{0}/Manifest.toml', github.action_path)"
        echo "${{ hashFiles(format('{0}/Manifest.toml', github.action_path), format('{0}/Project.toml', github.action_path), format('{0}/main.jl', github.action_path)) }}"
      shell: bash
    # - uses: actions/cache@v4
    #   id: cache-project
    #   with:
    #     path: ~/.julia
    #     key: cache-${{ runner.os }}-${{ hashFiles(format('{0}/Manifest.toml', github.action_path), format('{0}/Project.toml', github.action_path), format('{0}/main.jl', github.action_path)) }}
    - name: Install and precompile
      if: steps.cache-project.outputs.cache-hit != 'true'
      run: julia --project=${{ github.action_path }} -e 'import Pkg; Pkg.instantiate()'
      shell: bash
    # - uses: actions/cache/save@v3
    #   if: steps.cache-project.outputs.cache-hit != 'true'
    #   with:
    #     path: ~/.julia
    #     key: cache-${{ runner.os }}-${{ hashFiles(format('{0}/Manifest.toml', github.action_path), format('{0}/Project.toml', github.action_path), format('{0}/main.jl', github.action_path)) }}
    - name: Lint
      run: julia --project=${{ github.action_path }} ${{ github.action_path }}/main.jl
      shell: bash
